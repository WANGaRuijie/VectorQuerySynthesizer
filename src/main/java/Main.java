import ast.ASTPrinter;
import ast.QueryNode;
import ast.Visitor;
import ast.enums.AggregateFunction;
import ast.enums.DistanceOperator;
import ast.enums.PredicateOperator;
import ast.enums.SortOrder;
import ast.nodes.*;
import database.QueryExecutor;
import model.Table;

import java.util.Arrays;
import java.util.Collections;

import java.util.HashMap;
import java.util.Map;

public class Main {


        public static void main(String[] args) {
            QueryExecutor executor = new QueryExecutor();
            String testSql = "SELECT id FROM simple_wikipedia ORDER BY embedding <-> '[0.029250303,0.012057151,0.052902006,0.020010244,0.0149572715,-0.030033158,-0.0042879093,-0.030080603,-0.0012491576,0.0019082086,-0.019678123,0.017424451,-0.054040704,-0.011108235,0.024648065,0.0011579727,-0.052807115,-0.008326729,-0.03731608,0.03499124,-0.0002413061,0.01717536,-0.024553174,0.027020352,-0.024315946,-0.019334141,-0.024790403,0.0013314462,0.015918048,-0.004195983,0.020271195,-0.008083569,-0.02981965,0.009423912,0.027921822,-0.015265669,-0.015099608,-0.013616929,0.017543064,-0.045690253,-0.027613424,0.009275643,-0.03594015,-0.016475536,-0.002679202,-0.026142607,0.022536729,0.0020624073,0.005358404,-0.016226444,0.026142607,-0.0198086,-0.007638765,0.043412857,-0.033591587,-0.029297749,0.035370804,-0.026308667,0.02329586,-0.048774227,0.01097776,0.0041396413,-0.02271465,-0.02559698,-0.0013425663,0.030483892,-0.015585927,0.01394905,0.058595497,0.021398032,-0.00063866423,0.0914754,0.018610595,-0.030128049,-0.023224693,0.0013129128,0.01453026,0.054467715,-0.04953336,0.02246556,-0.0011994877,0.02832511,-0.016463675,0.0024434559,-0.02502763,-0.028396279,0.030887181,0.046046097,-0.030531337,-0.045785144,-0.007834479,-0.06779997,0.019357864,-0.023888933,-0.0065237903,-0.023248415,-0.00092370936,-0.052237768,-0.0437687,0.0133797005,0.03854967,-0.03741097,-0.053898368,0.013308532,0.0060493327,-0.0012951206,0.0057587274,0.0034754009,-0.00350802,0.004258256,-0.11510338,-0.018385226,-0.03831244,-0.012205418,-0.008652918,0.009465426,0.031836096,-0.019037606,0.025241137,-0.02806416,-0.039759535,0.028941905,-0.0071050003,0.018539425,0.020128857,-0.0033805093,0.044765063,0.008688502,0.029748483,-0.0026628925,0.036129937,0.0064526214,-0.038905513,-0.061584577,0.034967516,-0.046639167,0.024161747,0.023094216,0.015052163,-0.015348699,0.04094568,0.02476668,-0.013095026,0.036533225,0.06903356,-0.026118884,-0.02476668,0.007739587,0.0045192074,-0.030578783,-0.034730285,0.025834208,0.028847015,0.03354414,0.05432538,-0.018468257,0.031053241,0.020627039,0.010384688,0.009518803,-0.033259466,0.0038905512,-0.0075438735,-0.00022963,-0.050150152,0.0036948374,-0.05309179,-0.03269012,-0.026071437,-0.06675617,0.0022477421,-0.053756032,0.016736487,0.037695646,0.021113357,-0.0019689985,0.0036088421,0.0541356,0.00751422,0.022524867,0.02015258,0.019310419,0.0021676775,-0.016499259,0.0024864536,0.013178056,0.012644291,0.016617872,-0.04863189,0.0026525138,0.015657097,-0.034469336,0.025051353,-0.006150155,0.028538616,-0.014115109,0.025834208,-0.03176493,0.025454642,-0.00061086396,-0.005399919,0.05769403,0.021457339,0.0024627307,0.032879904,-0.02659334,0.031527698,-0.06604448,0.016107831,-0.034564227,0.0056193555,0.007988677,0.026213774,-0.0059485105,-0.025549535,0.032358,-0.056033425,-0.0031284539,0.003558431,0.01749562,0.018147998,-0.010313519,0.02486157,-0.035038684,-0.031171855,-0.04962825,0.056697667,0.015965493,-0.020377949,-0.00068648066,0.02130314,0.076150425,-0.010527025,-0.00087107427,-0.01659415,-0.047588084,-0.008807116,0.0041574333,-0.024315946,0.0046585794,0.0027058902,0.0057409354,-0.00036826055,0.03062623,-0.034659117,0.015253807,0.0026614098,-0.030270386,0.029914543,0.008042054,0.027138967,-0.05598598,-0.006369591,-0.010088152,0.029321471,-0.00020720447,-0.008125084,0.0066186814,-0.0073659522,-0.025146246,0.037126295,-0.015514759,-0.009726378,0.0032767218,0.01263243,-0.017531203,0.03477773,-0.0041811564,-0.01635692,-0.041894592,0.018147998,0.015265669,0.05608087,-0.034540504,-0.010248281,-0.015751988,0.0013551691,0.0026628925,0.04160992,-0.0040417844,0.015040302,-0.014245586,0.044954844,-0.036106214,9.961754e-05,0.0020520284,0.04144386,-0.01362879,0.015099608,-0.010663431,-0.017578648,-0.013818573,-0.02038981,-0.010230489,-0.042060655,-0.025478365,0.06998248,0.0016947028,-0.0092519205,0.012045288,0.017887047,-0.017199082,-0.031741206,0.036390886,0.00048594823,0.003789729,-0.049153794,0.009334951,0.022346947,0.017270252,0.01279849,0.022999326,-0.0012343307,-0.030958349,0.022762097,0.03582154,0.0028289526,-0.02642728,0.013960911,0.009382396,-0.07989863,-0.030104326,-0.0012172799,0.03508613,0.010793908,0.041823424,0.016665319,-0.038952958,-0.039735813,-0.044599,-0.039356247,-0.0908586,0.043389134,0.035987597,-0.04742202,0.04220299,0.02155223,-0.07382558,0.05252244,0.01527753,-0.022856988,-0.05665022,0.0042968052,0.0057290737,-0.03741097,-0.02080496,-0.032856178,-0.016238306,0.027115244,0.049058903,0.012988273,0.015372422,0.05612832,-0.01800566,-0.00014743395,-0.021350585,0.074489824,-0.007959024,-0.038004044,0.02237067,0.002526486,-0.047493193,0.01502844,-0.013877881,-0.035702925,-0.047896482,-0.017056746,0.042036932,-0.042226713,0.0045458954,0.052380104,-0.039024126,0.020947296,-0.08364685,-0.019523924,0.10988435,-0.037197463,-0.044812508,0.036865346,0.047920205,-0.023509366,0.013095026,-0.005672732,0.030317832,0.02766087,0.008225907,-0.030982072,-0.0005137485,0.055226848,0.027352473,0.013011996,0.00095484563,0.021291278,0.00043145975,0.014482814,0.00030543198,0.0018044211,0.024043132,-0.009038415,0.028965628,-0.016463675,0.017732847,0.016238306,-0.040257715,-0.0042137755,0.0007961989,0.0002603956,0.0015568136,-0.0004903963,-0.04962825,-0.012976412,-0.037695646,0.027542256,0.04953336,-0.013166195,-0.009334951,0.013782989,-0.009714517,-0.008623265,0.010948106,0.033069685,-0.050007816,-0.0067491573,-0.078000806,-0.033283193,0.043650087,0.019369725,-0.043223076,-0.030887181,-0.04229788,0.0035791884,-0.0014344925,-0.025336029,-0.02195552,0.01536056,-0.004258256,0.019346002,0.004353147,0.0032559643,0.020330502,0.04583259,-0.028965628,0.043484025,0.038763173,-0.0764351,0.045286965,0.02080496,0.012312171,-0.0076743495,0.027115244,-0.0063636606,-0.009862784,-0.01362879,-0.0014352339,0.02294002,0.024458282,-0.05921229,0.011564901,0.019595094,-0.040993124,-0.032334276,-0.052095428,0.00644076,0.030697398,-0.008160668,0.027589701,-0.010200836,0.016048525,-0.009192613,0.043934762,0.016012939,0.01114975,0.028586062,0.039000403,0.0068974253,0.056745112,-0.045381855,-0.008789324,0.046093542,0.009151098,0.004219706,0.024410836,0.0009192613,-0.019346002,-0.08910311,-0.026379835,0.010248281,0.008759671,0.020354224,-0.02806416,-0.042653725,0.018800378,-0.012822213,-0.009684863,0.008071708,-0.006488206,0.021409893,-0.0085580265,0.016546704,-0.06827443,-0.026000269,-0.013249225,0.0340186,-0.015538482,0.025668148,0.023189109,0.0886761,-0.04073217,-0.025122523,-0.012490093,-0.044622723,0.0126680145,0.022928156,0.032215662,-0.0013262569,-0.016297614,-0.008439412,0.0060048522,-0.034421887,0.017116053,-0.018029384,0.01477935,-0.008581749,0.0060315407,0.013023857,0.02550209,-0.03707885,0.043816146,-0.016155276,-0.025857931,0.021931795,0.029867098,-0.029843375,0.0083326595,0.0018251785,0.049912926,0.009839062,-0.011576762,-0.013699959,-0.006102709,0.010230489,-0.0028245046,-0.01792263,-0.03857339,-0.014684458,0.009465426,-0.025810486,0.04177598,-0.024885293,-0.018254751,0.056840003,-0.00075060653,0.0021943657,-0.035157297,-0.023794042,0.00027818774,-0.04383987,-0.000922968,-0.021836905,-0.024434559,-0.0072532683,0.055748753,0.004969942,0.034137215,0.00916296,0.02742364,0.011060789,-0.009489149,0.005236824,-0.024909018,0.036319718,-0.023983825,0.025857931,-0.009993261,-0.016807655,-0.033567864,0.020579593,-0.010022914,-0.0011676102,0.007941232,-0.011908882,-0.00085402344,-0.0078048254,0.019618817,-0.029843375,0.028253943,0.004365009,0.038620837,0.01469632,0.0035732577,-0.049343575,-0.00874781,0.024138024,0.015111471,-0.015692681,-0.018373365,-0.025122523,-0.009115514,0.0026806847,0.027044075,-0.020200027,0.0076921415,-0.031836096,-0.009815339,-0.01568082,0.011363256,0.040684726,-0.032879904,-0.0046674754,-0.05755169,0.0073778136,-0.02180132,-0.00050040433,0.009761962,-0.018634317,0.05921229,-0.047493193,-0.02766087,-0.010728669,0.0003154401,-0.009975468,0.013261086,-0.015147055,-0.008231837,0.021753876,-0.015977355,-0.039498582,-0.003433886,0.0076446957,-0.009993261,0.030009434,-0.015562205,-0.025122523,-0.043460302,0.002618412,-0.037695646,0.029131688,-0.008724087,0.0473983,0.013095026,0.024790403,0.024292221,0.03185982,0.020235611,0.02543092,-0.052285213,-0.014043941,-0.002262569,0.007870063,-0.015040302,-0.013972772,0.028467448,-0.0013529451,0.014542121,-0.01130988,0.01081763,0.02130314,0.015040302,-0.025003908,-0.015989216,-0.0056905244,-0.034113493,-0.00883084,0.012015635,0.02335517,0.024553174,0.0454293,0.020093273,0.017377004,0.031290468,-0.020698206,0.0574568,-0.0014241138,0.058880173,-0.032144494,-0.039688367,0.0071405848,-0.02203855,-0.0044005928,0.0541356,-0.027684594,-0.035157297,-0.03361531,0.028680954,0.016001077,0.005886238,0.029511254,-0.01296455,0.010912522,-0.020579593,-0.0056905244,0.0012276587,0.016392505,-0.0077929636,0.01584688,0.014969133,-0.005307993,-0.0026302736,0.019986521,-0.012051219,-0.015431729,0.00051634316,-0.02056773,-0.012181696,6.7183915e-05,0.019096913,0.0024360425,0.02550209,0.019286696,-0.018764792,0.017317697,-0.005746866,-0.0028556408,0.026688233,-0.03311713,-0.0056193555,0.016131554,0.02403127,-0.052190322,-0.012940827,0.00044369185,0.025383474,0.004483623,0.005414746,0.0011023723,0.0017332524,0.0029875992,-0.021398032,-0.047066182,0.0031818303,0.05076695,0.0074252593,-0.0022981532,-0.00031896145,-0.024742957,0.011683515,-0.023758458,0.009186682,-0.017720986,0.013284809,0.023129802,-0.008344521,-0.0061857393,0.014150694,-0.033805095,0.0120274965,0.009091791,-0.0022047446,-0.015894325,0.03864456,0.044883676,0.008409758,0.0022329155,0.01246637,0.014601428,-0.0075675966,0.013059442,-0.0016576358,-0.0034961584,0.0038668283,0.030887181,0.008119153,0.019832322,-0.009441704,-0.006861841,0.009655209,-0.03425583,-0.0031314192,0.001483421,0.005788381,-0.020745652,-0.0035791884,-0.027186412,0.014482814,0.032642674,0.013771128,-0.03418466,-0.0059099607,-0.036865346,0.020532146,-0.00841569,-0.005050007,-0.018124275,0.042796064,-0.00743119,-0.0384785,-0.020544007,-0.011535247,0.0042701173,-0.032666396,-0.0143167535,-0.038620837,-0.04920124,-0.03278501,-0.032761287,0.0017421485,0.014150694,-0.055606414,0.00495215,-0.024482004,0.02576304,0.0045607225,-0.0049136,-0.034943793,0.048442107,0.05812104,-0.008154738,0.049912926,0.00817253,-0.040898234,-0.01403208,-0.013154333,0.01709233,0.009939884,0.03897668,-0.02419733,0.007947163,0.01214018,0.018290335,0.03534708,0.019120635,0.0053791613,-0.008042054,-0.0026525138,-0.038905513,0.029345194,0.02526486,-0.024221053,-0.014565844,-0.017578648,-0.02502763,0.022180887,0.030317832,0.003567327,-0.02195552,0.013272948,0.0073778136,-0.005251651,0.01881224,0.03990187,0.03164631,0.002914948,0.00833859,-0.011659792,-0.011054859,-0.013261086,0.019357864,-0.016202722,-0.031076964,0.02559698,-5.1152445e-05,-0.01139291,0.025739318,0.0034546433,0.0041515026,-0.0278981,-0.019476479,0.024956463,0.03185982,-0.017412588,0.023284,0.008813048,0.008308936,-0.026284944,-0.004682302,-0.0055600484,-0.017033024,-0.026854292,0.0039231703,0.03824127,0.016475536,-0.0014500606,-0.015099608,0.0035554657,0.00573797,-0.012241002,-0.013403423,-0.03292735,0.0060582287,0.00027336905,-0.0007880442,-0.008860493,0.01288152,-0.016012939,-0.021409893,0.016285753,0.013118749,-0.027233858,0.013877881,0.031148132,-0.005465157,-0.024980186,0.03594015,0.0039409623,0.024671787,0.013640652,-0.013759267,0.0006438536,0.018551286,-0.04419571,-0.048489552,0.0039350316,-0.004961046,0.021575954,0.04073217,0.026451003,-0.007045693,0.053898368,-0.035275914,0.0045310687,-0.007033832,-0.05655533,0.037434693,0.023438198,0.00842162,0.044765063,-0.010491441,-0.028538616,-0.029250303,-0.0077573797,0.022833265,0.024315946,0.01238334,-0.046378218,-0.014577705,0.027447363,-0.000844386,-0.018112414,-0.024114301,-0.024790403,0.03062623,-0.013095026,-0.035987597,0.037529584,0.006120501,0.025407197,-0.02725758,-0.012822213,0.011772476,-0.0022447768,0.021445477,0.012762906,0.014435369,-0.024814125,0.015004717,0.0028482275,0.003656288,-0.010799838,0.0007161342,-0.03634344,-0.0013514624,-0.0440771,0.030792288,-0.039427415,-0.021528507,-0.0099102305,-0.005969268,0.029748483,0.012857798,-0.010016983,-0.03005688,-0.015668958,-0.01329667,-0.010165251,0.026972907,0.0002594689,0.018385226,-0.0011661275,0.01394905,0.047066182,-0.010924383,-0.007075347,0.015811294,0.038668282,-0.014743766,-0.043151908,0.021658983,-0.0037541448,0.01394905,0.0073540905,0.057504244,0.002943119,-0.019891629,0.0007457878,-0.0059485105,-0.0020846475,-0.02122011,0.0019423102,0.044053376,0.03510985,0.011849575,-0.008902008,-0.003632565,-0.029843375,0.016428089,0.018314058,-0.029179133,0.031527698,0.027803207,0.017531203,0.0022106753,-0.024482004,-0.00042775305,-0.011143819,-0.025478365,0.030222941,0.028657231,-0.00958404,0.00081399106,-0.022157164,-0.004219706,0.007075347,-0.02526486,-0.035489418,-0.0022877746,0.016499259,0.03427955,-0.044646446,0.03444561,0.0019927213,0.0024790403,0.016878825,-0.017732847,0.023485644,-0.060967784,-0.00052486855,0.03814638,0.035489418,-0.018420812,-0.00010471424,0.0015968459,0.0501976,-0.0037482139,0.010538886,0.0108650755,0.024434559,0.0075438735,-0.026237497,0.0025427954,0.01717536,-0.0041248146,-0.02294002,0.006517859,0.018456396,0.03532336,0.000613088,-0.018373365,0.015182639,0.018575009,0.010455856,0.004554792,0.004729748,-0.011137889,-0.023343308,0.039949317,-0.012513815,0.012181696,-0.0016353956,5.2038577e-06,-0.014233724,-0.0113336025,0.0035643617,0.018622456,-0.015111471,0.0170093,0.009423912,-0.0031966572,-0.030839736,0.019689985,0.025312306,-0.0016116727,-0.021077773,0.022928156,0.03790915,0.012739182,0.03427955,0.018017523,0.014328616,-0.03176493,-0.011594554,0.020923574,-0.018480118,0.026759401,-0.0033360291,-0.025810486,-0.013510176,-0.019476479,0.018420812,-0.035987597,-0.004812778,-0.0331883,0.011576762,-0.031005796,-0.00025650355,-0.029772205,-0.054040704,2.469588e-05,-0.004335355,0.024268499,0.008676641,0.0224537,0.01766168,-0.031836096,0.012324032,-0.0019171047,-0.024576897,-0.011410702,0.025786763,0.035631757,0.006814395,0.0085936105,0.003017253,-0.016475536,-0.028752122,-0.025857931,0.0259291,0.012644291,0.0037511792,-0.015668958,-0.022596037,0.0437687,0.013640652,-0.0029772206,-0.009210406,0.009299366,-0.029107966,0.033069685,-0.0029119826,-0.012501954,-0.01717536,0.011825852,-0.004554792,8.557841e-05,-0.037434693,-0.0025754145,0.011238711,0.007970885,0.0032085185,0.019939074,-0.004178191,0.027138967,0.016938131,0.00034398166,0.037363525,0.007193961,-0.016617872,-0.0077929636,0.029748483,-0.00048038817,-0.013450869,-0.01791077,-0.043412857,-0.012407063,-0.024043132,0.011730961,-0.0014196656,0.00073281437,0.034374442,0.004026958,0.015170777,0.009133306,-0.0027281304,0.016997438,0.0018044211,0.03344925,-0.015989216,-0.020164441,0.0024241812,0.014660736,0.0029979781,0.017424451,0.02742364,-0.018480118,-0.011327672,-0.007199892,0.060398433,-0.03722119,-0.015372422,0.034137215,-0.008480927,0.0125494,0.00029560924,-0.007401536,0.014542121,-0.011819921,0.006132363,0.005127106,0.025620703,-0.0033923709,0.004109988,0.015977355,0.012490093,0.0037511792,-0.00035473108,-0.033923708,-0.0015909151,0.019713707,0.022548592,0.0064941365,0.011938536,0.0025991374,-0.013154333,-0.034160938,0.006488206,-0.0125494,0.0023100148,-0.010461787,-0.026664509,0.025952823,0.018468257,-0.0060582287,0.019203667,-0.0106041245,0.00384014,0.0073066447,-0.013142472,0.00021146718,0.015265669,0.0042997706,-0.0012669497,-0.019144358,0.031480253,-0.0012254347,-0.016428089,-0.030389,-0.008605472,-0.022263916,0.012774767,-0.010295727,-0.0068025338,-0.026664509,-0.009572179,-0.004276048,-0.032832455,-0.010016983,-0.01502844,0.017270252,0.0015434694,-0.0024360425,0.00044739855,0.021362448,0.002725165,-0.0090443455,-0.04229788,-0.0011542661,0.004655614,0.043412857,-0.009690793,-0.018159859,-0.026308667,-0.008552096,-0.036604393,-0.034303274,0.0015805364,-0.0113513945,-0.0044687963,0.024624342,0.0009407602,0.0019778945,-0.034848902,-0.001684324,0.006529721,-0.014269308,0.0063873837,-0.03928508,-0.0038164172,0.0024716267,0.012857798,0.014210001,-0.011464078,-0.0011053376,0.0047505056,0.04002049,0.0027147862,-0.014708181,-0.024387114,0.0037274563,-0.02113708,0.02939264,0.00734816,0.0376482,0.03757703,0.010378757,0.048204876,-0.005168621,0.025668148,0.034137215,-0.02114894,0.00097412046,0.020745652,-0.021658983,0.005714247,-0.031219302,-0.023390753,-0.012157973,-0.024102438,0.0035347082,0.010378757,-0.0099813985,0.034160938,0.013415284,-0.033971153,-0.016665319,0.002493867,0.0048424313,-0.030602505,-0.031836096,0.018930852,0.008492788,0.01749562,0.038383607,-0.008629195,-0.00058936514,-0.028253943,0.017163498,0.013581345,-0.013581345,0.019500202,-0.027732039,-0.027589701,0.029985711,-0.004839466,-0.008985038,0.01453026,0.008617334,-0.012229141,0.012786629,-0.007887855,-0.014067664,0.009750101,-0.030483892,-0.0063043535,0.015467313,0.008190322,-0.009014692,-0.004969942,0.044622723,-0.019950936,-0.01271546,0.004246394,0.011553039,-0.019701846,-0.007822617,0.017804015,-0.048916563,0.010503302,-0.020994743,0.0021528506,0.042487666,-0.007413398,-0.020235611,-0.046354495,0.008036124,0.023177247,0.010562609,-0.026308667,0.039925594,-0.019500202,0.0058773416,0.008872354,-0.011517455,-0.0032470683,-0.0044895536,-0.03178865,0.03458795,-0.034967516,-0.019773014,0.03302224,0.03292735,0.0009911713,-0.038952958,0.004246394,0.018207304,0.01024235,-0.008581749,-0.018930852,-0.008356382,0.020140719,-0.02006955,-0.012116457,-0.0270678,0.032761287,0.008320798,0.014625152,-0.0058595496,-0.03748214,0.0050826254,0.00049929234,-0.006120501,-0.007810756,0.034540504,-0.00031840545,0.018254751,0.011665723,-0.02716269,0.0066720583,0.012193557,0.036129937,-0.026000269,0.03980698,-0.03805149,-0.005613425,0.008214044,0.00850465,-0.031503975,0.032666396,-0.047042456,0.02882329,0.028633507,-0.016712764,0.005399919,-0.0065237903,0.030199217,0.022845127,-0.008783394,0.0031076963,0.03394743,0.0005374713,0.05598598,0.008042054,-0.029179133,-0.0014545086,0.01800566,0.037553307,0.012810351,0.039688367,-0.018598732,0.0069330097,0.0154080065,0.014743766,-0.07064672,-0.02616633,0.008486858,0.01817172,0.0113336025,-0.019037606,-0.0065119285,0.03771937,0.0008184391,-0.003905378,-0.008261491,0.03342553,0.030934626,0.025810486,-0.028467448,0.02972476,-0.011719099,0.019666262,0.022026688,-0.024742957,0.04523952,0.00031933212,0.042250436,-0.019547647,0.02981965,-0.0142811695,-0.033401806,0.009483218,0.01536056,-0.006209462,0.017898908,-0.026783124,-0.020033967,0.0009518803,0.016973715,-0.034540504,0.018444534,-0.00404475,0.014921688,0.025122523,-0.02105405,-0.040518668,0.011031136,-0.00026910633,-0.021315001,-0.025715595,-0.031290468,0.00565494,0.034137215,-0.019725569,0.0009118479,0.01717536,0.014328616,-0.00022314327,0.0075675966,-0.01724653,0.001175765,-0.030128049,-0.048252326,-0.024956463,-0.015953632,-0.017566787,-0.00470306,0.022738375,-0.0055363257,0.009637417,-0.013284809,0.027352473,-0.002258121,0.031812374,-0.020033967,-0.029534977,-0.027945545,0.014008356,0.020377949,-0.005242755,0.033971153,-0.0061738775,-0.007982747,-0.009595902,0.06903356,-0.025193691,-0.022002965,-0.002360426,-0.03698396,0.0147319045,0.054894727,0.00850465,-0.021315001,0.03385254,-0.023533091,-0.03677045,-0.007787033,-0.007490497,-0.011363256,0.010467717,0.036509503,-0.009975468,-0.022287639,-0.024814125,-0.0015909151,0.0001421519,-0.0059307185,-0.028182773,0.019120635,0.036390886]' LIMIT 5;";
            Table result = executor.executeQuery(testSql);
            System.out.println(result);
        }


    /*public static void main(String[] args) {
        System.out.println("--- Building the full AST for the complex query using the new nodes ---");

        // Step 1: Build the AST for the scalar subquery inside the CTE's ORDER BY.
        // SQL: (SELECT binary_quantize(embedding) FROM simple_wikipedia WHERE title = 'Art')
        QueryNode scalarQueryForCte = new ProjectionNode(
                new SelectNode(
                        new TableNode("simple_wikipedia"),
                        new PredicateNode(
                                new ColumnReferenceNode("title"),
                                PredicateOperator.EQ,
                                new ConstantValueNode("Art")
                        )
                ),
                Collections.singletonList(
                        new AliasedExpression(
                                new FunctionCallNode("binary_quantize", Collections.singletonList(new ColumnReferenceNode("embedding")))
                        )
                )
        );
        ScalarSubqueryNode scalarSubqueryForCte = new ScalarSubqueryNode(scalarQueryForCte);


        // Step 2: Build the complete AST for the CTE body named 'initial_candidates'.
        // SQL: SELECT id, title, embedding FROM ... ORDER BY ... LIMIT 4
        QueryNode initialCandidatesAst = new LimitNode(
                new OrderByNode(
                        new ProjectionNode(
                                new TableNode("simple_wikipedia"),
                                Arrays.asList(
                                        new AliasedExpression(new ColumnReferenceNode("id")),
                                        new AliasedExpression(new ColumnReferenceNode("title")),
                                        new AliasedExpression(new ColumnReferenceNode("embedding"))
                                )
                        ),
                        Collections.singletonList(
                                new SortExpression(
                                        new DistanceExpressionNode(
                                                new FunctionCallNode("binary_quantize", Collections.singletonList(new ColumnReferenceNode("embedding"))),
                                                DistanceOperator.HAMMING_DISTANCE, // <~> operator
                                                scalarSubqueryForCte
                                        ),
                                        SortOrder.ASC // Default sort order
                                )
                        )
                ),
                4
        );


        // Step 3: Build the AST for the scalar subquery in the main query's SELECT list.
        // SQL: (SELECT embedding FROM simple_wikipedia WHERE title = 'Art')
        QueryNode scalarQueryForMain = new ProjectionNode(
                new SelectNode(
                        new TableNode("simple_wikipedia"),
                        new PredicateNode(
                                new ColumnReferenceNode("title"),
                                PredicateOperator.EQ,
                                new ConstantValueNode("Art")
                        )
                ),
                Collections.singletonList(new AliasedExpression(new ColumnReferenceNode("embedding")))
        );
        ScalarSubqueryNode scalarSubqueryForMain = new ScalarSubqueryNode(scalarQueryForMain);


        // Step 4: Build the AST for the main query body.
        // SQL: SELECT ... FROM initial_candidates ORDER BY cosine_distance LIMIT 3
        QueryNode mainQueryBodyAst = new LimitNode(
                new OrderByNode(
                        new ProjectionNode(
                                // The 'FROM' clause now correctly references the CTE name.
                                new TableNode("initial_candidates"),
                                Arrays.asList(
                                        new AliasedExpression(new ColumnReferenceNode("id")),
                                        new AliasedExpression(new ColumnReferenceNode("title")),
                                        // This is the aliased expression: ... AS cosine_distance
                                        new AliasedExpression(
                                                new DistanceExpressionNode(
                                                        new ColumnReferenceNode("embedding"),
                                                        DistanceOperator.COSINE_DISTANCE, // <=> operator
                                                        scalarSubqueryForMain
                                                ),
                                                "cosine_distance" // The alias
                                        )
                                )
                        ),
                        // ORDER BY clause can refer to the alias.
                        Collections.singletonList(new SortExpression(new ColumnReferenceNode("cosine_distance"), SortOrder.ASC))
                ),
                3
        );


        // Step 5: Assemble the final AST using the top-level WithNode.
        Map<String, QueryNode> ctes = new HashMap<>();
        ctes.put("initial_candidates", initialCandidatesAst);

        QueryNode finalAst = new WithNode(ctes, mainQueryBodyAst);


        // Step 6: Print the complete, unified AST using the updated ASTPrinter.
        System.out.println("\n--- Full AST Structure (using updated ASTPrinter) ---");
        Visitor<String, Integer> printer = new ASTPrinter();
        String astStructure = finalAst.accept(printer, 0);
        System.out.println(astStructure);
    }*/
}